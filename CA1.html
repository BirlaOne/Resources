<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>Cost Accounting QB - BirlaOne</title>
  <link rel="icon" type="image/png" href="https://i.ibb.co/N6QNPW56/logo-1-modified.png" />
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  
  <script>
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
    })();
  </script>

  <style>
    :root {
      --primary-accent: #C2185B;
      --primary-gradient: linear-gradient(90deg, #D32F2F, #C2185B);
      --danger-color: #e53935;
      --font-sans: 'Inter', sans-serif;
      --font-serif: 'Lora', serif;
      --border-radius: 14px;
      --transition-speed: 0.3s;
    }
    
    html[data-theme="light"] {
      --bg-color: #f7f7f9;
      --card-bg: #ffffff;
      --text-primary: #1c1c1e;
      --text-secondary: #636366;
      --border-color: #e5e5ea;
      --shadow: 0 6px 25px rgba(0, 0, 0, 0.07);
      --header-bg: rgba(255, 255, 255, 0.8);
      --input-bg: #f0f0f0;
      --table-header-bg: #f2f2f2;
    }

    html[data-theme="dark"] {
      --bg-color: #121212;
      --card-bg: #1e1e1e;
      --text-primary: #f2f2f7;
      --text-secondary: #98989f;
      --border-color: #38383a;
      --shadow: 0 6px 25px rgba(0, 0, 0, 0.2);
      --header-bg: rgba(28, 28, 30, 0.75);
      --input-bg: #2c2c2e;
      --table-header-bg: #2c2c2e;
    }
      
    html[data-theme="sepia"] {
        --bg-color: #f4ecd8;
        --card-bg: #fbf5e9;
        --text-primary: #5b4636;
        --text-secondary: #7d6b59;
        --border-color: #dcd0b9;
        --primary-accent: #a98244;
        --primary-gradient: linear-gradient(135deg, #c5a265, #a98244);
        --shadow: 0 6px 25px rgba(0, 0, 0, 0.1);
        --header-bg: rgba(244, 236, 216, 0.8);
        --input-bg: #e9deca;
        --table-header-bg: #e9deca;
    }

    /* Base & Layout Styles */
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    body {
      font-family: var(--font-serif);
      background-color: var(--bg-color);
      color: var(--text-primary);
      transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
    }

    /* Header & Sidebar */
    .top-bar { font-family: var(--font-sans); display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; background: var(--header-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border-color); }
    .top-bar .title { font-family: 'Pacifico', cursive; font-size: 26px; font-weight: 400; color: var(--text-primary); }
    .menu-toggle { background: none; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; }
    .menu-icon { color: var(--text-primary); font-size: 24px; }
    .sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 199; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; }
    .sidebar-overlay.active { opacity: 1; visibility: visible; }
    .sidebar { position: fixed; top: 0; left: 0; width: 280px; height: 100%; background: var(--card-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); box-shadow: 2px 0 20px rgba(0,0,0,0.2); transform: translateX(-100%); transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94); z-index: 200; display: flex; flex-direction: column; font-family: var(--font-sans); }
    .sidebar.active { transform: translateX(0); }
    .sidebar-profile-card { display: flex; align-items: center; gap: 15px; padding: 20px; border-bottom: 1px solid var(--border-color); }
    .sidebar-profile-img { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--primary-accent); object-fit: cover; flex-shrink: 0; }
    .sidebar-user-info { overflow: hidden; }
    #sidebar-username { font-weight: 600; font-size: 18px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    #sidebar-user-id { font-size: 14px; color: var(--text-secondary); }
    .sidebar nav { flex-grow: 1; padding: 10px 0; }
    .sidebar nav a { display: flex; align-items: center; gap: 15px; color: var(--text-primary); text-decoration: none; padding: 15px 20px; font-weight: 500; font-size: 16px; transition: background-color 0.2s, color 0.2s; border-radius: 0 30px 30px 0; margin-right: 10px; }
    .sidebar nav a:hover, .sidebar nav a.active { background-color: rgba(194, 24, 91, 0.1); color: var(--primary-accent); }
    .nav-icon { width: 24px; height: 24px; stroke-width: 2; }
    .sidebar-footer { padding: 20px; margin-top: auto; border-top: 1px solid var(--border-color); }
    .logout-button { width: 100%; padding: 12px; border: none; border-radius: 8px; background: var(--danger-color); color: white; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
    
    .theme-selector select {
      background-color: var(--input-bg);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 6px 10px;
      font-family: var(--font-sans);
      font-size: 14px;
      -webkit-appearance: none; appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23888' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 8px center;
      padding-right: 28px;
      transition: all var(--transition-speed) ease;
    }
    
    .theme-selector select:focus {
        outline: 2px solid var(--primary-accent);
        outline-offset: 2px;
    }

    /* Content Styles */
    .container { padding: 16px; max-width: 800px; margin: 0 auto; position: relative; }
    .topic-title { font-family: var(--font-sans); font-size: 28px; font-weight: 700; margin-top: 30px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 4px solid var(--primary-accent); color: var(--primary-accent); }
    .note-card { background: var(--card-bg); border: 1px solid var(--border-color); border-radius: var(--border-radius); box-shadow: var(--shadow); margin-bottom: 24px; overflow: hidden; transition: all var(--transition-speed) ease; }
    .note-title { font-family: var(--font-sans); font-size: 22px; font-weight: 700; padding: 18px 22px; background: var(--primary-gradient); color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .note-body { padding: 12px 22px 22px 22px; }
    .note-body h3 { font-family: var(--font-sans); font-size: 1.2rem; font-weight: 700; border-bottom: 2px solid var(--primary-accent); padding-bottom: 6px; margin-top: 24px; margin-bottom: 12px; }
    .note-body p, .note-body li { margin-bottom: 16px; text-align: left; line-height: 1.8; font-size: 17px; }
    .note-body strong { font-family: var(--font-sans); font-weight: 700; color: var(--primary-accent);}
    .note-body ul, .note-body ol { padding-left: 25px; }

    .table-wrapper { overflow-x: auto; -webkit-overflow-scrolling: touch; margin: 1.5em 0; }
    .styled-table { width: 100%; border-collapse: collapse; font-family: var(--font-sans); min-width: 600px; }
    .styled-table th, .styled-table td { padding: 12px 15px; border: 1px solid var(--border-color); text-align: left; }
    .styled-table thead tr { background-color: var(--table-header-bg); font-weight: bold; color: var(--text-primary); }
    .styled-table tbody tr:nth-of-type(even) { background-color: rgba(0,0,0,0.02); }
    .styled-table td:first-child { font-weight: 500; }
    .styled-table .final-row { font-weight: bold; background-color: rgba(194, 24, 91, 0.05); }

    /* Permission Lock Styles */
    #main-content-wrapper.locked > *:not(.lock-overlay) { filter: blur(8px); -webkit-filter: blur(8px); pointer-events: none; }
    .lock-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; z-index: 2; }
    .lock-overlay-content { background: rgba(var(--card-bg-rgb), 0.7); backdrop-filter: blur(2px); -webkit-backdrop-filter: blur(2px); padding: 20px 30px; border-radius: 12px; box-shadow: var(--shadow); font-weight: 600; font-size: 16px; border: 1px solid var(--border-color); font-family: var(--font-sans); }
  </style>
</head>
<body>
  
  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-profile-card">
      <img src="" id="sidebarProfilePic" class="sidebar-profile-img" alt="Profile"/>
      <div class="sidebar-user-info">
        <div id="sidebar-username">Loading...</div>
        <div id="sidebar-user-id">Student ID: ...</div>
      </div>
    </div>
    <nav>
      <a href="https://birlaone.github.io/BirlaOne/index.html"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg><span>Home</span></a>
      <a href="#"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg><span>QB (Marathi)</span></a>
      <a href="#" class="active"><svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><line x1="8" y1="6" x2="16" y2="6"></line><line x1="16" y1="10" x2="8" y2="10"></line><line x1="16" y1="14" x2="8" y2="14"></line><line x1="16" y1="18" x2="8" y2="18"></line></svg><span>QB (Cost Accounting)</span></a>
    </nav>
    <div class="sidebar-footer">
      <button class="logout-button" onclick="logout()">Logout</button>
    </div>
  </aside>

  <header class="top-bar">
    <button class="menu-toggle" onclick="toggleSidebar()"><span class="menu-icon">☰</span></button>
    <h1 class="title">BirlaOne</h1>
    <div class="theme-selector">
        <select id="themeSelect" onchange="changeTheme(this.value)" aria-label="Select theme">
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="sepia">Sepia</option>
        </select>
    </div>
  </header>

  <main class="container" id="main-content-wrapper">
      </main>

<script>
    const SUPABASE_URL = 'https://eikriuddsuguybvvyzjl.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVpa3JpdWRkc3VndXlidnZ5empsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMjIxNTAsImV4cCI6MjA3MzY5ODE1MH0.HNh2gGO8nWzAjxh5Oa3cs_8WKaq9mq9TyLCvPOkcr2c';
    const client = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
      document.getElementById('sidebarOverlay').classList.toggle('active');
    }
    
    function changeTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
    }

    async function logout() {
      await client.auth.signOut();
      window.location.href = "https://birlaone.github.io/BirlaOne/login.html";
    }

    async function fetchAndSetCurrentUser(session) {
      const { data, error } = await client.from('users').select('id, img, name').eq('auth_id', session.user.id).single();
      if (error || !data) {
        console.error('Error fetching user profile:', error);
        return null;
      }
      const picUrl = data.img || 'https://t4.ftcdn.net/jpg/05/89/93/27/360_F_589932782_vQAEAZhHnq1QCGu5ikwrYaQD0Mmurm0N.jpg';
      document.getElementById('sidebarProfilePic').src = picUrl;
      document.getElementById('sidebar-username').innerText = data.name || 'Student';
      document.getElementById('sidebar-user-id').innerText = `Student ID: ${data.id || 'N/A'}`;
      return data;
    }
    
    function renderCostAccountingQB(container) {
        const qbData = [
            {
                topic: "ABC Costing",
                questions: [
                    {
                        title: "Q.1) Determine overhead per unit under Traditional and ABC approach.",
                        content: `
                            <h3>a) Traditional Approach</h3>
                            <p>Under the traditional approach, overhead is allocated using a single rate based on direct labour hours.</p>
                            <p><strong>Step 1: Calculate Total Direct Labour Hours</strong><br>
                            Product A: 500 units × 1 hour/unit = 500 hours<br>
                            Product B: 1,250 units × 2 hours/unit = 2,500 hours<br>
                            Total Labour Hours = 500 + 2,500 = 3,000 hours</p>
                            <p><strong>Step 2: Calculate Overhead Rate per Labour Hour</strong><br>
                            $${'\\begin{align} \\text{Overhead Rate} &= \\frac{\\text{Total Overhead Cost}}{\\text{Total Direct Labour Hours}} \\\\ &= \\frac{₹2,61,780}{3,000 \\text{ hours}} \\\\ &= ₹87.26 \\text{ per hour} \\end{align}'}$$</p>
                            <p><strong>Step 3: Allocate Overhead and Calculate Per Unit Cost</strong><br>
                            <strong>Product A:</strong> 500 hours × ₹87.26 = ₹43,630. Overhead per unit = ₹43,630 / 500 units = <strong>₹87.26</strong><br>
                            <strong>Product B:</strong> 2,500 hours × ₹87.26 = ₹2,18,150. Overhead per unit = ₹2,18,150 / 1,250 units = <strong>₹174.52</strong></p>
                            
                            <h3>b) Activity-Based Costing (ABC) Approach</h3>
                            <p>Under ABC, overhead is allocated using multiple rates based on specific activities (cost drivers).</p>
                            <p><strong>Step 1: Calculate Cost Driver Rates</strong><br>
                            Machine Setups: ₹27,140 / 46 setups = <strong>₹590 per setup</strong><br>
                            Maintenance: ₹1,83,040 / 4,160 sq. ft. = <strong>₹44 per sq. ft.</strong><br>
                            Inspections: ₹51,600 / 344 inspections = <strong>₹150 per inspection</strong></p>
                            <p><strong>Step 2: Allocate Overhead and Calculate Per Unit Cost</strong></p>
                            <div class="table-wrapper"><table class="styled-table">
                                <thead><tr><th>Activity</th><th>Product A Calculation</th><th>Product A Cost</th><th>Product B Calculation</th><th>Product B Cost</th></tr></thead>
                                <tbody>
                                    <tr><td>Machine Setups</td><td>20 × ₹590</td><td>₹11,800</td><td>26 × ₹590</td><td>₹15,340</td></tr>
                                    <tr><td>Maintenance</td><td>1,620 × ₹44</td><td>₹71,280</td><td>2,540 × ₹44</td><td>₹1,11,760</td></tr>
                                    <tr><td>Inspections</td><td>56 × ₹150</td><td>₹8,400</td><td>288 × ₹150</td><td>₹43,200</td></tr>
                                    <tr class="final-row"><td><strong>Total Overhead</strong></td><td></td><td><strong>₹91,480</strong></td><td></td><td><strong>₹1,70,300</strong></td></tr>
                                </tbody>
                            </table></div>
                            <p><strong>Overhead per unit (Product A):</strong> ₹91,480 / 500 units = <strong>₹182.96</strong><br>
                            <strong>Overhead per unit (Product B):</strong> ₹1,70,300 / 1,250 units = <strong>₹136.24</strong></p>
                        `
                    },
                    {
                        title: "Q.2) Calculate overheads absorbed using activity-based costing.",
                        content: `
                            <p><strong>Step 1: Calculate Total Activity for Each Cost Driver</strong><br>
                            Total Machine Hours: (1,000 units × 6 hrs) + (2,000 units × 1.5 hrs) = 9,000 hours<br>
                            Total Setups: 15 + 50 = 65 setups<br>
                            Total Orders: 18 + 70 = 88 orders</p>
                            <p><strong>Step 2: Calculate Cost Driver Rates</strong><br>
                            Machine Activity Rate: ₹3,00,000 / 9,000 hours = <strong>₹33.33 per machine hour</strong><br>
                            Set-up Rate: ₹30,000 / 65 setups = <strong>₹461.54 per setup</strong><br>
                            Order Rate: ₹35,000 / 88 orders = <strong>₹397.73 per order</strong></p>
                            <p><strong>Step 3: Allocate Overheads to Each Product</strong></p>
                            <div class="table-wrapper"><table class="styled-table">
                                <thead><tr><th>Activity</th><th>Product A Calculation</th><th>Product A Cost</th><th>Product B Calculation</th><th>Product B Cost</th></tr></thead>
                                <tbody>
                                    <tr><td>Machine Activity</td><td>6,000 × ₹33.33</td><td>₹1,99,980</td><td>3,000 × ₹33.33</td><td>₹99,990</td></tr>
                                    <tr><td>Set-ups</td><td>15 × ₹461.54</td><td>₹6,923</td><td>50 × ₹461.54</td><td>₹23,077</td></tr>
                                    <tr><td>Orders</td><td>18 × ₹397.73</td><td>₹7,159</td><td>70 × ₹397.73</td><td>₹27,841</td></tr>
                                    <tr class="final-row"><td><strong>Total Overheads Absorbed</strong></td><td></td><td><strong>₹2,14,062</strong></td><td></td><td><strong>₹1,50,908</strong></td></tr>
                                </tbody>
                            </table></div>
                        `
                    }
                ]
            },
            {
                topic: "Material",
                questions: [
                    {
                        title: "Q.7) Prepare a Stores Ledger Account using FIFO method.",
                        content: `
                            <p>FIFO stands for "First-In, First-Out". Under this method, the materials that are received first are issued first. The inventory is priced at the cost of the oldest stock.</p>
                            <div class="table-wrapper"><table class="styled-table">
                                <thead><tr><th>Date</th><th>Particulars</th><th>Receipts (Qty@Rate=Amt)</th><th>Issues (Qty@Rate=Amt)</th><th>Balance (Qty@Rate=Amt)</th></tr></thead>
                                <tbody>
                                    <tr><td>Jul 1</td><td>Received</td><td>1000 @ 20 = 20000</td><td>-</td><td>1000 @ 20 = 20000</td></tr>
                                    <tr><td>Jul 3</td><td>Received</td><td>350 @ 21 = 7350</td><td>-</td><td>1000 @ 20 = 20000<br>350 @ 21 = 7350</td></tr>
                                    <tr><td>Jul 5</td><td>Issued</td><td>-</td><td>700 @ 20 = 14000</td><td>300 @ 20 = 6000<br>350 @ 21 = 7350</td></tr>
                                    <tr><td>Jul 7</td><td>Issued</td><td>-</td><td>300 @ 20 = 6000<br>100 @ 21 = 2100</td><td>250 @ 21 = 5250</td></tr>
                                    <tr><td>Jul 12</td><td>Received</td><td>550 @ 22 = 12100</td><td>-</td><td>250 @ 21 = 5250<br>550 @ 22 = 12100</td></tr>
                                    <tr><td>Jul 16</td><td>Issued</td><td>-</td><td>250 @ 21 = 5250<br>100 @ 22 = 2200</td><td>450 @ 22 = 9900</td></tr>
                                    <tr><td>Jul 21</td><td>Received</td><td>100 @ 23 = 2300</td><td>-</td><td>450 @ 22 = 9900<br>100 @ 23 = 2300</td></tr>
                                    <tr><td>Jul 24</td><td>Issued</td><td>-</td><td>450 @ 22 = 9900<br>50 @ 23 = 1150</td><td>50 @ 23 = 1150</td></tr>
                                    <tr><td>Jul 27</td><td>Received</td><td>200 @ 20 = 4000</td><td>-</td><td>50 @ 23 = 1150<br>200 @ 20 = 4000</td></tr>
                                    <tr class="final-row"><td>Jul 31</td><td>Issued</td><td>-</td><td>50 @ 23 = 1150<br>130 @ 20 = 2600</td><td><strong>70 @ 20 = 1400</strong></td></tr>
                                </tbody>
                            </table></div>
                        `
                    },
                    {
                        title: "Q.10) Calculate Reorder Level, Maximum Level, Minimum Level, and Average Stock Level.",
                        content: `
                            <p><strong>Given Data:</strong><br>
                            Maximum Usage: 600 units/month, Minimum Usage: 400 units/month, Normal Usage: 450 units/month, Max. Reorder Period: 6 months, Min. Reorder Period: 2 months, Reorder Quantity (ROQ): 1,500 units</p>
                            
                            <p><strong>a) Reorder Level (ROL)</strong><br>
                            $${'\\text{ROL} = \\text{Max. Usage} \\times \\text{Max. Reorder Period}'}$$
                            $${'= 600 \\text{ units} \\times 6 \\text{ months} = 3,600 \\text{ units}'}$$</p>
                            
                            <p><strong>b) Maximum Level</strong><br>
                            $${'\\text{Max. Level} = \\text{ROL} + \\text{ROQ} - (\\text{Min. Usage} \\times \\text{Min. Reorder Period})'}$$
                            $${'= 3,600 + 1,500 - (400 \\times 2) = 4,300 \\text{ units}'}$$</p>
                            
                            <p><strong>c) Minimum Level</strong><br>
                            Average Reorder Period = (6 + 2) / 2 = 4 months<br>
                            $${'\\text{Min. Level} = \\text{ROL} - (\\text{Normal Usage} \\times \\text{Avg. Reorder Period})'}$$
                            $${'= 3,600 - (450 \\times 4) = 1,800 \\text{ units}'}$$</p>
                            
                            <p><strong>d) Average Stock Level</strong><br>
                            $${'\\text{Avg. Stock Level} = \\text{Min. Level} + \\frac{1}{2} \\times \\text{ROQ}'}$$
                            $${'= 1,800 + \\frac{1}{2} \\times 1,500 = 2,550 \\text{ units}'}$$</p>
                        `
                    },
                    {
                        title: "Q.11) Ascertain the Economic Order Quantity (EOQ) and the number of orders.",
                        content: `
                            <p><strong>Given Data:</strong><br>
                            Annual Consumption (A): 15,000 Kg<br>
                            Ordering Cost (O): ₹48 per order<br>
                            Carrying Cost (C): 8% of ₹2 = ₹0.16 per unit per year</p>
                            
                            <p><strong>Step 1: Calculate Economic Order Quantity (EOQ)</strong><br>
                            $${'\\begin{align} EOQ &= \\sqrt{\\frac{2 \\times A \\times O}{C}} \\\\ &= \\sqrt{\\frac{2 \\times 15,000 \\times 48}{0.16}} \\\\ &= \\sqrt{90,00,000} \\\\ &= 3,000 \\text{ Kg} \\end{align}'}$$
                            The <strong>Economic Order Quantity is 3,000 Kg</strong>.</p>
                            
                            <p><strong>Step 2: Calculate the Number of Orders to be Placed</strong><br>
                            $${'\\text{Number of Orders} = \\frac{\\text{Annual Consumption}}{EOQ} = \\frac{15,000}{3,000} = 5 \\text{ orders}'}$$</p>
                        `
                    }
                ]
            },
            {
                topic: "Labour",
                questions: [
                    {
                        title: "Q.13) Work out the earnings of a worker under various wage systems.",
                        content: `
                            <p><strong>Basic Calculations:</strong><br>
                            Standard Time: 50 hours, Time Taken: 48 hours, Time Saved: 2 hours, Rate: ₹3.75/hr, Actual Output: 150 pieces, Standard Output: 144 pieces.</p>

                            <p><strong>1. Straight Piece Rate System</strong><br>
                            $${'\\text{Earnings} = 150 \\text{ pieces} \\times ₹1.50/\\text{piece} = ₹225'}$$</p>
                            
                            <p><strong>2. Differential Piece Rate System</strong> (120% rate as output is above standard)<br>
                            $${'\\text{Earnings} = 150 \\text{ pieces} \\times (₹1.50 \\times 1.20) = ₹270'}$$</p>
                            
                            <p><strong>3. Halsey Premium System (50% Bonus)</strong><br>
                            $${'\\begin{align} \\text{Earnings} &= (\\text{Time Taken} \\times \\text{Rate}) + (50\\% \\times \\text{Time Saved} \\times \\text{Rate}) \\\\ &= (48 \\times 3.75) + (0.50 \\times 2 \\times 3.75) \\\\ &= ₹180 + ₹3.75 = ₹183.75 \\end{align}'}$$</p>
                            
                            <p><strong>4. Rowan System</strong><br>
                            $${'\\begin{align} \\text{Earnings} &= (\\text{Time Taken} \\times \\text{Rate}) + \\left( \\frac{\\text{Time Saved}}{\\text{Standard Time}} \\times \\text{Time Taken} \\times \\text{Rate} \\right) \\\\ &= (48 \\times 3.75) + \\left( \\frac{2}{50} \\times 48 \\times 3.75 \\right) \\\\ &= ₹180 + ₹7.20 = ₹187.20 \\end{align}'}$$</p>
                        `
                    },
                     {
                        title: "Q.15) Calculate Labour Turnover Rate and Labour Flux Rate.",
                        content: `
                            <p><strong>Given Data:</strong><br>
                            Separations: 400 (80 left + 320 discharged), Replacements: 300</p>
                            
                            <p><strong>Step 1: Calculate Average Number of Workers</strong><br>
                            $${'\\text{Average Workers} = \\frac{7,600 + 8,400}{2} = 8,000'}$$</p>
                            
                            <p><strong>Step 2: Calculate Labour Turnover Rates</strong></p>
                            <p><strong>Separation Method:</strong><br>
                            $${'\\text{Rate} = \\frac{400}{8,000} \\times 100 = 5\\%'}$$</p>
                            
                            <p><strong>Replacement Method:</strong><br>
                            $${'\\text{Rate} = \\frac{300}{8,000} \\times 100 = 3.75\\%'}$$</p>
                            
                            <p><strong>Flux Method (Labour Flux Rate):</strong><br>
                            $${'\\text{Rate} = \\frac{400 + 300}{8,000} \\times 100 = 8.75\\%'}$$</p>
                        `
                    }
                ]
            },
            {
                topic: "Overhead",
                questions: [
                    {
                        title: "Q.18) Prepare a statement showing apportionment of costs to various departments.",
                        content: `
                            <p>This statement, known as the Primary Overhead Distribution Summary, allocates indirect costs to different departments on an equitable basis.</p>
                            <div class="table-wrapper"><table class="styled-table">
                                <thead>
                                    <tr><th>Particulars</th><th>Basis of Apportionment</th><th>Total (₹)</th><th>Dept A (₹)</th><th>Dept B (₹)</th><th>Dept C (₹)</th><th>Dept D (₹)</th></tr>
                                </thead>
                                <tbody>
                                    <tr><td>Rent</td><td>Floor Space (15:11:9:5)</td><td>2,000</td><td>750</td><td>550</td><td>450</td><td>250</td></tr>
                                    <tr><td>Maintenance</td><td>Cost of Machinery (4:3:2:1)</td><td>1,200</td><td>480</td><td>360</td><td>240</td><td>120</td></tr>
                                    <tr><td>Depreciation</td><td>Cost of Machinery (4:3:2:1)</td><td>900</td><td>360</td><td>270</td><td>180</td><td>90</td></tr>
                                    <tr><td>Lighting</td><td>Floor Space (15:11:9:5)</td><td>200</td><td>75</td><td>55</td><td>45</td><td>25</td></tr>
                                    <tr><td>Insurance (Stock)</td><td>Stock of Goods (5:3:2:0)</td><td>1,000</td><td>500</td><td>300</td><td>200</td><td>-</td></tr>
                                    <tr><td>Employer's Contribution to P.F.</td><td>Direct Wages (4:3:2:1)</td><td>300</td><td>120</td><td>90</td><td>60</td><td>30</td></tr>
                                    <tr><td>Energy</td><td>Cost of Machinery (4:3:2:1)</td><td>1,800</td><td>720</td><td>540</td><td>360</td><td>180</td></tr>
                                    <tr><td>Supervision</td><td>Number of Workers (2:3:1.5:1)</td><td>3,000</td><td>960</td><td>1,440</td><td>360</td><td>240</td></tr>
                                    <tr class="final-row"><td><strong>Total Overheads</strong></td><td></td><td><strong>10,400</strong></td><td><strong>3,965</strong></td><td><strong>3,605</strong></td><td><strong>1,895</strong></td><td><strong>935</strong></td></tr>
                                </tbody>
                            </table></div>
                        `
                    },
                    {
                        title: "Q.21) Work out overhead application rates using different methods.",
                        content: `
                             <p><strong>Given Data:</strong> Factory Overheads: ₹62,000, Direct Labour Cost: ₹1,00,000, Direct Labour Hours: 1,55,000, Machine Hours: 50,000, Direct Material Cost: ₹2,00,000</p>

                            <p><strong>a) Direct Labour Hour Rate</strong><br>
                            $${'\\text{Rate} = \\frac{₹62,000}{1,55,000 \\text{ hrs}} = ₹0.40 \\text{ per direct labour hour}'}$$</p>
                            
                            <p><strong>b) Direct Labour Cost Rate</strong><br>
                            $${'\\text{Rate} = \\frac{₹62,000}{₹1,00,000} \\times 100 = 62\\% \\text{ of Direct Labour Cost}'}$$</p>
                            
                            <p><strong>c) Machine Hour Rate</strong><br>
                            $${'\\text{Rate} = \\frac{₹62,000}{50,000 \\text{ hrs}} = ₹1.24 \\text{ per machine hour}'}$$</p>
                            
                            <p><strong>d) Prime Cost Rate</strong><br>
                            Prime Cost = ₹2,00,000 (Material) + ₹1,00,000 (Labour) = ₹3,00,000<br>
                            $${'\\text{Rate} = \\frac{₹62,000}{₹3,00,000} \\times 100 = 20.67\\% \\text{ of Prime Cost}'}$$</p>
                        `
                    }
                ]
            }
        ];

        let html = '';
        qbData.forEach(topicData => {
            html += `<h2 class="topic-title">${topicData.topic}</h2>`;
            topicData.questions.forEach(q => {
                html += `
                    <article class="note-card">
                        <h2 class="note-title">${q.title}</h2>
                        <div class="note-body">${q.content}</div>
                    </article>
                `;
            });
        });
        container.innerHTML = html;
    }

    async function initializeApp(session) {
        const currentUser = await fetchAndSetCurrentUser(session);
        if (!currentUser) {
          alert("Could not load your profile. Please log in again.");
          logout();
          return;
        }

        const mainContent = document.getElementById('main-content-wrapper');
        renderCostAccountingQB(mainContent);
    }

    document.addEventListener("DOMContentLoaded", async () => {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.getElementById('themeSelect').value = savedTheme;
        
        const { data: { session } } = await client.auth.getSession();

        if (session && session.user) {
            initializeApp(session);
        } else {
            window.location.href = "https://birlaone.github.io/BirlaOne/login.html";
        }

        client.auth.onAuthStateChange((_event, session) => {
            if (!session) {
                window.location.href = "https://birlaone.github.io/BirlaOne/login.html";
            }
        });
    });
</script>
</body>
</html>
